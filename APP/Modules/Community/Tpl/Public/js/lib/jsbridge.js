define('lib/jsbridge', [], function(require, exports, module) {});
window.JsBridge=function(a,f,g){if(a){return a}var a={};a.SCENE_NONE=0;a.SCENE_DOWNLOADER=1;a.SCENE_DOWNLOADER_DETAIL=2|a.SCENE_DOWNLOADER;a.SCENE_DOWNLOADER_EXTERNAL=4|a.SCENE_DOWNLOADER;a.SCENE_DOWNLOADER_SDK=8|a.SCENE_DOWNLOADER;a.SCENE_MOBILEQ=16;a.SCENE_WECHAT=32;a.SCENE=a.SCENE_NONE;a._greaterThanOrEqual=function(j,k){j=String(j).split(".");k=String(k).split(".");try{for(var h=0,n=Math.max(j.length,k.length);h<n;h++){var l=isFinite(j[h])&&Number(j[h])||0,m=isFinite(k[h])&&Number(k[h])||0;if(l<m){return false}else if(l>m){return true}}}catch(o){return false}return true};var c=[];function e(){var h=document.createElement("iframe");c.push(h);h.lastUse=Date.now();h.style.cssText="position:absolute;left:0;top:0;width:0;height:0;visibility:hidden;";h.frameBorder="0";document.body.appendChild(h);return h}a._callWithScheme=function(j){console.log("JsBridge._callWithScheme: ",j);var h;for(var k=0;h=c[k];k++){if(Date.now()-h.lastUse>=1e3){h.lastUse=Date.now();break}}(h||e()).src=j};a.ready=false;var d=[];a.onReady=function(h){a.ready?h&&h():h&&d.push(h)};a._readyCallback=function(){if(a.ready){return}a.ready=true;for(var h=0,j;j=d[h];h++){j()}};var b=function(h,i,j){this.args=h||{};this.callback=i;this.context=j;this.identifier=0;this.state=1;this.percentage=0;this._init()};b._instances={};b.HAS_PERCENTAGE=true;b.STATE_READY=1;b.STATE_QUEUING=2;b.STATE_DOWNLOADING=3;b.STATE_PAUSED=4;b.STATE_DOWNLOADED=5;b.STATE_INSTALLING=6;b.STATE_INSTALLED=7;b.STATE_FAILED=8;b._getDownloadState=function(h,i){h=b._stateMap[h];i&&h==b.STATE_FAILED&&(h=b.STATE_READY);return h};b.prototype._callback=function(i,h){if(i){this.state=i;switch(this.state){case b.STATE_READY:case b.STATE_QUEUING:case b.STATE_FAILED:this.percentage=0;break;case b.STATE_DOWNLOADED:case b.STATE_INSTALLING:case b.STATE_INSTALLED:this.percentage=100;break}}h&&((this.state==b.STATE_DOWNLOADING||this.state==b.STATE_PAUSED)&&b.HAS_PERCENTAGE&&isFinite(h.percentage)&&(this.percentage=h.percentage),h.identifier&&(delete b._instances[this.identifier],b._instances[this.identifier=h.identifier]=this));this.callback&&this.callback.call(this,this.state,this.percentage,this.context)};a.Download=b;a.SHARE_USER_SELECTION=0;a.SHARE_MOBILEQ=1;a.SAHRE_QZONE=2;a.SAHRE_WECHAT=3;a.SAHRE_WECHAT_TIMELINE=4;a.SHARE_USER_SELECTION_POPUP=5;a._shareInfo={iconUrl:"",jumpUrl:location.href,title:document.title,summary:location.href,message:"",appBarInfo:""};a.setShareInfo=function(h){h=h||{};h.allowShare==1||h.allowShare===true?a._showShareButton&&a._showShareButton():(h.allowShare==0||h.allowShare===false)&&a._hideShareButton&&a._hideShareButton();var i=a._shareInfo;i.iconUrl=h.iconUrl||i.iconUrl;i.jumpUrl=h.jumpUrl||i.jumpUrl;i.title=h.title||i.title;i.summary=h.summary||i.summary;i.message=h.message||i.message;i.appBarInfo=h.appBarInfo||i.appBarInfo;a._setShareInfo&&a._setShareInfo(h)};return a}(window.JsBridge,window);(function(a,d,j){if(!a||a.SCENE!=a.SCENE_NONE){return}var i=navigator.userAgent.match(/\/qqdownloader\/(\d+)(?:\/(appdetail|external|sdk))?/);if(i){switch(i[2]){case"appdetail":a.SCENE=a.SCENE_DOWNLOADER_DETAIL;break;case"external":a.SCENE=a.SCENE_DOWNLOADER_EXTERNAL;break;case"sdk":a.SCENE=a.SCENE_DOWNLOADER_SDK;break;default:a.SCENE=a.SCENE_DOWNLOADER;break}}else{return}var f=1,e={},c=a._call=function(o,k,p){var l=["jsb:/",o,f,"JsBridge.callback?"].join("/"),m=[];for(var n in k){m.push(encodeURIComponent(n)+"="+encodeURIComponent(k[n]+""))}l+=m.join("&");e[f++]={cb:p};a._callWithScheme(l)};a._callBatch=function(o,p){var k=[];for(var l=0,m;m=p[l];l++){k.push({method:o,seqid:f++,args:m})}var n=["jsb://callBatch",f++,"JsBridge.callback?param="].join("/");n+=encodeURIComponent(JSON.stringify(k));a._callWithScheme(n)};a.callback=function(k){console.log("JsBridge.callback: ",k);e[k.seqid]&&(e[k.seqid].cb&&e[k.seqid].cb(k),delete e[k.seqid])};var b=a.Download;b._stateMap={QUEUING:b.STATE_QUEUING,DOWNLOADING:b.STATE_DOWNLOADING,PAUSED:b.STATE_PAUSED,DOWNLOADED:b.STATE_DOWNLOADED,INSTALLING:b.STATE_INSTALLING,INSTALLED:b.STATE_INSTALLED,FAIL:b.STATE_FAILED};b._privateInstances=[];b.prototype._init=function(){b._privateInstances.push(this);var k=this;c("queryDownload",{appid:this.args.hnAppId,packagename:this.args.packageName},function(l){if(l.result==0){var m=JSON.parse(l.data),n=b._getDownloadState(m.appstate,true),o=m.downpercent;k.identifier?k._callback(n,{percentage:o}):c("createDownload",{appid:k.args.hnAppId,packagename:k.args.packageName},function(p){if(p.result==0){var q=JSON.parse(p.data);k._callback(n,{identifier:q.apkid,percentage:o})}else{k._callback(b.STATE_FAILED)}})}else{k._callback(b.STATE_READY)}})};b.prototype._onResume=function(){this._init()};b.prototype.start=function(){switch(this.state){case b.STATE_READY:case b.STATE_FAILED:if(!this.identifier){var k=this;c("createDownload",{appid:this.args.hnAppId,packagename:this.args.packageName},function(l){var m=b.STATE_READY;if(l.result==0){var n=JSON.parse(l.data);k._callback(m,{identifier:n.apkid});k.start()}else{k._callback(b.STATE_FAILED)}});break}case b.STATE_PAUSED:c("startDownload",{apkid:this.identifier});break;default:this._callback();break}return true};b.prototype.stop=function(){c("pauseDownload",{apkid:this.identifier});return true};b.prototype.install=function(){c("startDownload",{apkid:this.identifier});return true};d.stateCallback=function(l){if(l.result==0){var k=JSON.parse(l.data),m=b._getDownloadState(k.appstate);if(k.apkid&&m){var n=b._instances[k.apkid];n&&n._callback(m,{percentage:k.down_percent})}}};a.getAppInstalledVersion=function(l,k){c("getAppInfo",{packagenames:l.join(",")},function(o){var p={};if(o.result==0){var m=JSON.parse(o.data);for(var n in m){m[n].install==1&&(p[n]=m[n].verCode)}}k&&k(p)});return true};a.startApp=function(k,l){c("startOpenApp",{packageName:k,scene:l});return true};a._showShareButton=function(){c("setWebView",{buttonVisible:1})};a._hideShareButton=function(){c("setWebView",{buttonVisible:0})};a.share=function(l){var k=a._shareInfo;c("share",{title:k.title,summary:k.summary,iconUrl:k.iconUrl,jumpUrl:k.jumpUrl,type:l||a.SHARE_USER_SELECTION,message:k.message,appBarInfo:k.appBarInfo});return true};d.clickCallback=function(){a.share()};a.showPictures=function(l,k){c("showPics",{urls:JSON.stringify(l),position:isFinite(k)&&k>=0&&k<l.length?k:0});return true};a.openNewWindow=function(k){c("openNewWindow",{url:k});return true};var g;a.login=function(k){c("openLoginActivity",{logintype:"QMOBILEQ"});g=k;return true};d.loginCallback=function(k){g&&g(k);g=j};var h;a.onResume=function(k){h=k};d.activityStateCallback=function(m){if(m.data=="onResume"){var n=b._privateInstances;b._privateInstances=[];for(var k=0,l;l=n[k];k++){l._onResume()}typeof h=="function"&&h()}};d.userFitCallback=function(){};d.readyCallback=a._readyCallback})(window.JsBridge,window);(function(b,h,i){if(!b||b.SCENE!=b.SCENE_NONE){return}var f=navigator.userAgent.match(/V1_AND_SQ_([\d\.]+)/);if(f&&b._greaterThanOrEqual(f[1],"4.6")){b.SCENE=b.SCENE_MOBILEQ}else{return}var g=1,d={},c=b._call=function(n){var k=["jsbridge:/",n];k.push(g);var m;for(var l=1,o=arguments.length;l<o;l++){var j=arguments[l];if(typeof j=="function"){m=j;break}k.push(encodeURIComponent(typeof j=="object"?JSON.stringify(j):j+""))}d[g++]={cb:m};b._callWithScheme(k.join("/"))};b.callback=function(j,k){console.log("JsBridge.callback: ",j,k);d[j]&&(d[j].cb&&d[j].cb(k.result),delete d[j])};var a=b.Download;a._stateMap={20:a.STATE_QUEUING,2:a.STATE_DOWNLOADING,12:a.STATE_DOWNLOADING,3:a.STATE_PAUSED,10:a.STATE_PAUSED,4:a.STATE_DOWNLOADED,5:a.STATE_INSTALLING,6:a.STATE_INSTALLED,13:a.STATE_INSTALLED,"-1":a.STATE_FAILED,"-2":a.STATE_FAILED,"-3":a.STATE_FAILED,"-4":a.STATE_FAILED,"-5":a.STATE_FAILED,"-6":a.STATE_FAILED};a.prototype._getDownloadParam=function(j){return{myAppConfig:0,appid:this.args.sngAppId,myAppId:this.args.hnAppId,versionCode:this.args.versionCode,url:this.args.url,packageName:this.args.packageName,actionCode:j,appName:this.args.alias,isAutoDownload:1,isAutoInstall:0}};a.prototype._init=function(){var j=this;c("q_download/getQueryDownloadAction",[this.args.sngAppId],!!this.args.isUpdate,function(){j._callback(a.STATE_READY,{identifier:j.args.sngAppId})})};a.prototype.start=function(){switch(this.state){case a.STATE_READY:case a.STATE_FAILED:c("q_download/doDownloadAction",this._getDownloadParam(this.args.isUpdate?12:2));break;case a.STATE_PAUSED:c("q_download/doDownloadAction",this._getDownloadParam(2));break;default:this._callback();break}return true};a.prototype.stop=function(){c("q_download/doDownloadAction",this._getDownloadParam(3));return true};a.prototype.install=function(){c("q_download/doDownloadAction",this._getDownloadParam(5));return true};function e(j,k){if(Object.prototype.toString.call(j)=="[object Array]"){for(var l=0,m;m=j[l];l++){e(m,k)}return}var n=a._getDownloadState(j.state,k);if(j.appid&&n){var o=a._instances[j.appid];o&&o._callback(n,{percentage:j.pro})}}a.callback=function(j){e(j)};b.onReady(function(){c("q_download/registerDownloadCallBackListener","JsBridge.Download.callback")});h.publicAccountDownload={queryProcess:function(j){e(j,true)}};b.getAppInstalledVersion=function(k,j){c("qzone_app/getAppInfoBatch",k.join(","),",",false,false,false,function(l){l=l?JSON.parse(l):[];var n={};for(var o=0,m;m=l[o];o++){n[m[0]]=m[1]}j&&j(n)});return true};b.startApp=function(j){c("qqZoneAppList/startApp",j,"");return true};b._setShareInfo=function(){var j=b._shareInfo;c("QQApi/setShareInfo",{share_url:j.jumpUrl,title:j.title,desc:j.summary,image_url:j.iconUrl})};b.share=function(){return false};b.showPictures=function(){return false};b.openNewWindow=function(j){c("QQApi/openUrl",{url:j,target:1});return true};b.login=function(){return false};b.getLoginTicket=function(){return null};b._readyCallback()})(window.JsBridge,window);(function(a,g,h){if(!a||a.SCENE!=a.SCENE_NONE){return}var d=navigator.userAgent.match(/MicroMessenger\/([\d\.]+)/);if(d&&a._greaterThanOrEqual(d[1],"5.0")){a.SCENE=a.SCENE_WECHAT}else{return}var b=a.Download,c="JsBridge-Download";function f(j,k){if(window.localStorage){var i=localStorage.getItem(c);if(i){try{return JSON.parse(i)[[j,k].join("|")].downloadId||0}catch(l){}}}return 0}function e(n,o,l){if(window.localStorage){var i=localStorage.getItem(c);if(i){try{var j=JSON.parse(i);i={};for(var k in j){m-j[k].timestamp<7*24*3600&&(i[k]=j[k])}}catch(p){i={}}}else{i={}}var m=Date.now();l&&(i[[n,o].join("|")]={timestamp:m,downloadId:l});localStorage.setItem(c,JSON.stringify(i));return true}return false}b._stateMap={downloading:b.STATE_DOWNLOADING,download_succ:b.STATE_DOWNLOADED,download_fail:b.STATE_FAILED};b.HAS_PERCENTAGE=false;b.prototype._init=function(){var i=f(this.args.md5,this.args.url);if(i){var j=this;WeixinJSBridge.invoke("queryDownloadTask",{download_id:i},function(k){j._callback(k.err_msg.indexOf("query_download_task:ok")>=0?b._getDownloadState(k.state,true):b.STATE_READY,{identifier:i})})}else{this._callback(b.STATE_READY)}};b.prototype.start=function(){switch(this.state){case b.STATE_READY:case b.STATE_PAUSED:case b.STATE_FAILED:var i=this;WeixinJSBridge.invoke("addDownloadTask",{task_name:this.args.alias,task_url:this.args.url,file_md5:this.args.md5},function(j){j.err_msg.indexOf("add_download_task:ok")>=0?(e(i.args.md5,i.args.url,j.download_id),i._callback(b.STATE_DOWNLOADING,{identifier:j.download_id})):i._callback(b.STATE_FAILED)});break;default:this._callback();break}return true};b.prototype.stop=function(){var i=this;WeixinJSBridge.invoke("cancelDownloadTask",{download_id:this.identifier},function(j){e(i.args.md5,i.args.url);i._callback(b.STATE_READY)});return true};b.prototype.install=function(){WeixinJSBridge.invoke("installDownloadTask",{download_id:this.identifier});return true};a.onReady(function(){WeixinJSBridge.on("wxdownload:state_change",function(i){var j=b._getDownloadState(i.state);if(i.download_id&&j){var k=b._instances[i.download_id];k&&k._callback(j)}})});a.getAppInstalledVersion=function(k,n){var m=k.length,o={};for(var j=0,p=m;j<p;j++){WeixinJSBridge.invoke("getInstallState",{packageName:k[j]},function(i){return function(q){if(q.err_msg.indexOf("get_install_state:yes")>=0){var l=q.err_msg.split("_");l=l.length>0?Number(l[l.length-1]):0;o[i]=l}m--;m==0&&n&&n(o)}}(k[j]))}return true};a.startApp=function(i,j){WeixinJSBridge.invoke("launch3rdApp",{type:1,packageName:i,signature:j});return true};a._showShareButton=function(){WeixinJSBridge.call("showOptionMenu")};a._hideShareButton=function(){WeixinJSBridge.call("hideOptionMenu")};a._setShareInfo=function(){a.onReady(function(){WeixinJSBridge.on("menu:share:appmessage",function(){a.share(a.SAHRE_WECHAT)});WeixinJSBridge.on("menu:share:timeline",function(){a.share(a.SAHRE_WECHAT_TIMELINE)})});delete a._setShareInfo};a.share=function(j){var i=a._shareInfo;WeixinJSBridge.invoke(j==a.SAHRE_WECHAT?"sendAppMessage":"shareTimeline",{appid:"wx3909f6add1206543",img_url:i.iconUrl,img_width:72,img_height:72,link:i.jumpUrl,desc:i.summary,title:i.title});return true};a.showPictures=function(j,i){WeixinJSBridge.invoke("imagePreview",{current:j[isFinite(i)&&i>=0&&i<j.length?i:0],urls:j});return true};a.openNewWindow=function(){return false};a.login=function(){return false};a.getLoginTicket=function(){return null};window.WeixinJSBridge?a._readyCallback():document.addEventListener("WeixinJSBridgeReady",a._readyCallback,false)})(window.JsBridge,window);
