<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/bootstrap/css/bootstrap2.2.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/uniform/themes/default/css/uniform.default.css" media="screen" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/jquery-easyui-1.3.5/themes/default/easyui.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/jquery-easyui-1.3.5/themes/icon.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/uiColorButtonStyle.css" />
<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/myUniformStyle.css" />
<script type="text/javascript" src="__PUBLIC__/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/uniform/jquery.uniform.js"></script>
<script type="text/javascript" src="__PUBLIC__/jquery-easyui-1.3.5/jquery.easyui.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/lhgcalendar/lhgcore.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/lhgcalendar/lhgcalendar.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/myUniformCalendar.js"></script>
<title>添加趣味刮刮卡活动</title>
</head>

<body>
    <form id="myForm" name="myForm" class="form-horizontal uniform" action="" method="post" style="margin:0px; background:#fafafa;border:1px solid #DDD;min-width:800px;" enctype="multipart/form-data">
        <input type="hidden" id="editflag" name="editflag" value="{$editflag}" />
        <input type="hidden" id="activity_id" name="activity_id" value="{$epainfo[0].plugin_activity_id}" />
        <div class="control-group" style="margin-top:20px;">
            <div class="controls controls-row">编辑趣味刮刮卡活动开始内容</div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
 				关键词<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myinput" id="keyword" name="keyword" placeholder="请输入活动关键字" required="required" value="{$epainfo[0].keyword}" />
            </div>
            <div class="controls controls-row">只能写一个关键词，用户输入此关键词将会触发此活动。</div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				活动名称<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myinput" id="activity_title" name="activity_title" placeholder="请输入活动名称" required="required" value="{$epainfo[0].plugin_activity_title}" />
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				兑奖信息<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myinput" id="getprize_info" name="getprize_info" placeholder="请输入客户兑奖时的信息" required="required" value="{$epainfo[0].getprize_tip}" />
            </div>
            <div class="controls controls-row">
				请不要多于100字! 这个设定是用户输入兑奖时候的显示信息!
            </div>
        </div>
       
        <div class="control-group">
            <label class="control-label">活动开始图片</label>
            <div class="controls">
                <input type="text" class="uniform myinput" id="activity_startimage" name="activity_startimage" value="http://www.we-act.cn/APP/Tpl/Admin/Public/images/scratchcard/activity-scratch-card-start.jpg" />
                <br/>
				<div class="btn">
                    <span style="font-size:12px;">添加附件:</span>
                    <input type="file" name="picture[]" class="input-text uniform" />
                </div>
				<div class="activity_img" style="margin-top:10px;">
                	<img src="__PUBLIC__/images/scratchcard/activity-scratch-card-start.jpg" id="startdisplay" name="startdisplay" style="width:100px;" />
                </div>                                       
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">活动简介</label>
            <div class="controls controls-row">
                <textarea id="activity_brief" name="activity_brief" class="uniform mytextarea" placeholder="" value="{$epainfo[0].plugin_activity_brief}"></textarea>
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
            	活动开始时间<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform mytimeinput" id="startdate" name="startdate" placeholder="请选择活动开始时间" required="required" value="{$epainfo[0].plugin_activity_startdate}" />
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				活动结束时间<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform mytimeinput" id="enddate" name="enddate" placeholder="请选择活动结束时间" required="required" value="{$epainfo[0].plugin_activity_enddate}" />
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">活动说明</label>
            <div class="controls controls-row">
                <textarea id="activity_detail" name="activity_detail" class="uniform mytextarea" placeholder="">{$epainfo[0].plugin_activity_detail}</textarea>
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				重复抽奖回复<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myinput" id="repeatplay_tip" name="repeatplay_tip" placeholder="请输入重复抽奖回复" required="required" value="{$epainfo[0].repeatplay_tip}" />
            </div>
            <div class="controls controls-row">
				备注：如果设置只允许抽一次奖，请写：你已经玩过了，下次再来。 如果设置可多次抽奖，请写：亲，继续努力哦！
            </div>
        </div>

        <div class="control-group">
            <div class="controls controls-row">编辑活动结束内容</div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				活动结束标题<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myinput" id="activity_endtitle" name="activity_endtitle" placeholder="" required="required" value="{$epainfo[0].activity_endtitle}" />
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				活动结束说明
            </label>
            <div class="controls controls-row">
                <textarea id="activity_endinfo" name="activity_endinfo" class="uniform mytextarea" placeholder="">{$epainfo[0].activity_endinfo}</textarea>
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">活动结束图片</label>
            <div class="controls">
                <input type="text" class="uniform myinput" id="activity_endimage" name="activity_endimage" value="http://www.we-act.cn/weact/APP/Tpl/Admin/Public/images/scratchcard/activity-scratch-card-end.jpg" />
                <br/>
				<div class="btn">
                    <span>添加附件:</span>
                    <input type="file" name="picture[]" class="input-text uniform" />
                </div>
                <div class="activity_img" style="margin-top:10px;">
					<img src="__PUBLIC__/images/scratchcard/activity-scratch-card-end.jpg" id="enddisplay" name="enddisplay" style="width:100px;" />
                </div>                                          
            </div>
        </div>
        
        <div class="control-group">
            <div class="controls controls-row">奖项设置</div>
        </div>
        <div class="control-group">
            <label class="control-label">
				一等奖奖品名称设置<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform mybriefinput" id="first_prize" name="first_prize" placeholder="请输入一等奖奖品" required="required" value="{$epainfo[0].prize_content}" />
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				一等奖奖品数量<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myamountinput" id="first_prize_amount" name="first_prize_amount" placeholder="" required="required" value="{$epainfo[0].prize_amount}" />
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">二等奖奖品名称设置</label>
            <div class="controls controls-row">
                <input type="text" class="uniform mybriefinput" id="second_prize" name="second_prize" placeholder="" value="{$epainfo[1].prize_content}" />
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">二等奖奖品数量</label>
            <div class="controls controls-row">
                <input type="text" class="uniform myamountinput" id="second_prize_amount" name="second_prize_amount" placeholder="" value="{$epainfo[1].prize_amount}" />
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">三等奖奖品名称设置</label>
            <div class="controls controls-row">
                <input type="text" class="uniform mybriefinput" id="third_prize" name="third_prize" placeholder="" value="{$epainfo[2].prize_content}" />
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">三等奖奖品数量</label>
            <div class="controls controls-row">
                <input type="text" class="uniform myamountinput" id="third_prize_amount" name="third_prize_amount" placeholder="" value="{$epainfo[2].prize_amount}" />
            </div>
        </div>

    	<div class="control-group">
            <div class="controls controls-row">
                <a id="addmoreprize" class="large colorbutton blue" href="javascript:void(0)s">显示更多奖项</a>
            </div>
        </div>
        
        <div id="morePrize" style="display:none;">
            <div class="control-group">
                <label class="control-label">四等奖奖品名称设置</label>
                <div class="controls controls-row">
                    <input type="text" class="uniform mybriefinput" id="fourth_prize" name="fourth_prize" placeholder="" value="{$epainfo[3].prize_content}" />
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">四等奖奖品数量</label>
                <div class="controls controls-row">
                    <input type="text" class="uniform myamountinput" id="fourth_prize_amount" name="fourth_prize_amount" placeholder="" value="{$epainfo[3].prize_amount}" />
                </div>
            </div>
            
    
            <div class="control-group">
                <label class="control-label">五等奖奖品名称设置</label>
                <div class="controls controls-row">
                    <input type="text" class="uniform mybriefinput" id="fifth_prize" name="fifth_prize" placeholder="" value="{$epainfo[4].prize_content}" />
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">五等奖奖品数量</label>
                <div class="controls controls-row">
                    <input type="text" class="uniform myamountinput" id="fifth_prize_amount" name="fifth_prize_amount" placeholder="" value="{$epainfo[4].prize_amount}" />
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">六等奖奖品名称设置</label>
                <div class="controls controls-row">
                    <input type="text" class="uniform mybriefinput" id="sixth_prize" name="sixth_prize" placeholder="" value="{$epainfo[5].prize_content}" />
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">六等奖奖品数量</label>
                <div class="controls controls-row">
                    <input type="text" class="uniform myamountinput" id="sixth_prize_amount" name="sixth_prize_amount" placeholder="" value="{$epainfo[5].prize_amount}" />
                </div>
            </div>
            
        </div>
    	
        <div class="control-group">
            <div class="controls controls-row">刮刮卡活动其他设置</div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				预计活动的人数<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myamountinput" id="participation" name="participation" placeholder="" required="required" value="{$epainfo[0].participation}" />
            </div>
            <div class="controls controls-row">
		               预估活动人数直接影响抽奖概率：中奖概率 = 奖品总数/(预估活动人数*每人抽奖次数)，<br/>
		               如果要确保任何时候都100%中奖建议设置为1人参加。
            </div>
        </div>
        
        <div class="control-group">
            <label class="control-label">
				每人最多允许抽奖次数<span class="text-error">(*)</span>
            </label>
            <div class="controls controls-row">
                <input type="text" class="uniform myamountinput" id="total_times" name="total_times" placeholder="" required="required" value="{$epainfo[0].total_times}" />
            </div>
            <div class="controls controls-row">必须1-5之间的数字。</div>
        </div>
       
        <div class="control-group">
            <div class="controls controls-row">
                <div class="checker" id="uniform-jiangpin_num_show_yes">
                	<span><input type="checkbox" class="uniform" id="hide_amount" name="hide_amount" /></span>
                </div>不显示奖品数量
            </div>
        </div>
        
        <div class="control-group">
            <div class="controls controls-row">
                <div class="checker" id="uniform-ifeveryday_yes">
                	<span><input type="checkbox" checked="checked" class="uniform" id="play_everyday" name="play_everyday" /></span>
                </div>每天可抽奖
            </div>
        </div>
        
        <div class="control-group">
            <div class="controls controls-row">
                <div class="checker" id="uniform-moren_yes">
                	<span><input type="checkbox" class="uniform" id="focus_alert" name="focus_alert" /></span>
                </div>关注后即弹出本活动
            </div>
        </div>
		
        <div class="form-actions no-margin" style="margin-bottom:0px; background:#fafafa;">
            <a id="submitbtn" class="large ui-color-button light-green" href="javascript:void(0)">提交</a>
            &nbsp;&nbsp;
            <a id="resetbtn" class="large ui-color-button blue" href="javascript:void(0)">重置</a>
            <a href="javascript:history.go(-1);">
                <img style="width:50px; float:right;" alt="返回" src="__PUBLIC__/images/goback.png" />
            </a>
        </div>
	</form>
	
<script type="text/javascript">
$(function(){
	var editflag = $("#editflag").val();							//该页面加载时是否编辑的标记
	if(editflag=='0'){
		$("#myForm").attr("action", "{:U('Admin/PluginManage/addScratchCardConfirm','','')}");	//设置添加活动的提交路径
		//如果是添加活动信息，则要把默认设置填入表单中，给客户贴心默认设置，省去工作量

		var cur_pat = '趣味刮刮卡，大奖刮出来';						//活动标题
		$("#activity_title").val(cur_pat);							//设置活动标题

		var cur_pad = '亲，请点击进入大转盘抽奖活动页面，祝您好运哦！';	//活动说明
		$("#activity_detail").val(cur_pad);							//设置活动标题

		var cur_as = 'http://www.we-act.cn/weact/APP/Tpl/Admin/Public/images/scratchcard/activity-scratch-card-start.jpg';				
		//活动开始图片路径
		$("#activity_startimage").val(cur_as);						//设置活动开始图片路径

		var cur_aei = 'http://www.we-act.cn/weact/APP/Tpl/Admin/Public/images/scratchcard/activity-scratch-card-end.jpg';				
		//活动结束图片路径
		$("#activity_endimage").val(cur_aei);						//设置活动结束图片路径
		
		var cur_aet = '趣味刮刮卡活动已经结束了';						//活动结束标题
		$("#activity_endtitle").val(cur_aet);						//设置活动结束标题
		
		var cur_aein = '亲，活动已经结束，请继续关注我们的后续活动哦。';	//活动结束说明
		$("#activity_endinfo").val(cur_aein);						//设置活动结束说明
		
		var cur_key = '趣味刮刮卡';									//活动关键字
		$("#keyword").val(cur_key);									//设置活动关键字
		
		var cur_gt = '兑奖请联系我们，电话1366666XXXX，兑奖截止时间为：';//兑奖信息
		$("#getprize_info").val(cur_gt);							//设置兑奖信息
		
		var cur_rt = '亲，今天的次数已经使用完啦，请明天继续努力吧！';	//重复抽奖提示
		$("#repeatplay_tip").val(cur_rt);							//设置重复抽奖提示

		
	}else{
		$("#myForm").attr("action", "{:U('Admin/PluginManage/editScratchCardConfirm','','')}");	//设置编辑活动的提交路径
	}
});
/*表单提交按钮*/
$(function(){
	$("#submitbtn").click(function(){
		//验证表单是否完整
	  	var key =  $("#keyword");				//活动关键字
	  	var at =  $("#activity_title");			//活动名称
	  	var sd =  $("#startdate");				//活动开始日期
	  	var ed =  $("#enddate");				//活动结束日期
	  	var gi =  $("#getprize_info");			//兑奖信息
	  	var rt =  $("#repeatplay_tip");			// 重复抽奖回复
	  	var aet =  $("#activity_endtitle");		//活动结束标题
	  	var fp =  $("#first_prize");			//一等奖奖品名称设置
	  	var fpa =  $("#first_prize_amount");	// 一等奖奖品数量
	  	var pa =  $("#participation");			//预计活动的人数
	  	var tt =  $("#total_times");			//每人最多允许抽奖次数
	  	if(key.val()==""){
	  		$.messager.alert('温馨提示', '请输入活动关键字！','warning', function(){
	  			key.focus();					//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(at.val()==""){
	  		$.messager.alert('温馨提示', '请输入活动名称！','warning', function(){
	  			at.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(sd.val()==""){
	  		$.messager.alert('温馨提示', '请选择活动开始日期！','warning', function(){
	  			sd.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(ed.val()==""){
	  		$.messager.alert('温馨提示', '请选择活动结束日期！','warning', function(){
	  			ed.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(ed.val()<sd.val()){
	  		$.messager.alert('温馨提示', '活动结束日期不得早于开始日期！','warning', function(){
	  			ed.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(gi.val()==""){
	  		$.messager.alert('温馨提示', '请输入兑奖信息！','warning', function(){
	  			gi.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(rt.val()==""){
	  		$.messager.alert('温馨提示', '请输入重复抽奖回复！','warning', function(){
	  			rt.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(aet.val()==""){
	  		$.messager.alert('温馨提示', '请输入活动结束标题！','warning', function(){
	  			aet.focus();					//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(fp.val()==""){
	  		$.messager.alert('温馨提示', '请输入一等奖奖品设置！','warning', function(){
	  			fp.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(fpa.val()=="" || isNaN(fpa.val()) ){
	  		$.messager.alert('温馨提示', '一等奖数量不能为空，且必须为数字！','warning', function(){
	  			fpa.focus();					//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(pa.val()=="" || isNaN(pa.val())){
	  		$.messager.alert('温馨提示', '预计活动人数不能为空，且必须为数字！','warning', function(){
	  			pa.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else if(tt.val()=="" || isNaN(tt.val()) || tt.val()<1 || tt.val()>5 ){
	  		$.messager.alert('温馨提示', '每人最多允许抽奖次数不能为空，且必须为1~5之间的数字！','warning', function(){
	  			tt.focus();						//注意聚焦和return的顺序！
	  		});
	  		return								//注意聚焦和return的顺序！
	  	}else{
			$.messager.confirm('温馨提示', '确定提交吗？', function(result){
				if(result == true){				//用户确认
					$('#myForm').submit();		//提交form表单给控制器，注意设置Action的URL
				}else{
					return						//用户取消提交
				}
			});
		} 
	});
});
/*表单重置按钮*/
$(function(){
	$("#resetbtn").click(function(){
		$.messager.confirm('温馨提示', '确定重置信息？', function(result){
			if(result == true){
				//window.location.reload();
				//如果是编辑状态，则重置为编辑前的样子；
				//如果是添加状态，则重置为默认添加的样子；
				//一定要注意区分！不能简单的window.location.reload()，而且也重置不干净。
			}
		});
	});
});
</script>
</body>
</html>
